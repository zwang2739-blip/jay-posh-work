<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WORK | JAY POSH</title>
    
    <link rel="icon" type="image/png" href="images/favicon.png">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Cormorant+Garamond:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">
    
    <style>
        /* --- 全局設定 --- */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            background-color: #f8f8f6; /* 極淺的米灰色，比純白更有質感 */
            color: #000000; 
            font-family: 'Inter', sans-serif; 
            overflow: hidden; 
            height: 100vh;
            width: 100vw;
            user-select: none;
        }
        
        /* --- Header --- */
        header {
            position: fixed; top: 0; left: 0; width: 100%; 
            padding: 30px 50px;
            z-index: 1000; 
            pointer-events: none; 
        }
        .header-content { pointer-events: auto; display: flex; width: 100%; justify-content: space-between; align-items: center; }
        .logo { font-family: 'Cormorant Garamond', serif; font-size: 1.3rem; font-weight: 700; text-transform: uppercase; color: #000; text-decoration: none;}
        .nav-links { display: flex; gap: 30px; }
        .nav-link { font-size: 0.8rem; text-transform: uppercase; letter-spacing: 1px; color: #000; text-decoration: none; position: relative; }
        .nav-link.active::after { content: ''; position: absolute; bottom: -5px; left: 0; width: 100%; height: 1px; background: #000; }

        /* --- 互動畫布 --- */
        #gallery-canvas {
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            cursor: grab;
        }
        #gallery-canvas.grabbing { cursor: grabbing; }

        /* --- 圖片樣式 --- */
        .gallery-img-container {
            position: absolute;
            /* 預設位置：螢幕正中央 (這樣JS載入前不會亂跑) */
            top: 0; left: 0; 
            
            /* 動畫設定：讓位移、旋轉、寬高變化都很滑順 */
            transition: transform 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94), width 0.8s ease, height 0.8s ease;
            
            transform-origin: center center;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08); /* 輕微陰影 */
            background: #ddd; /* 圖片載入前的佔位色 */
        }
        
        .gallery-img-container img {
            width: 100%; height: 100%; object-fit: cover;
            display: block;
            pointer-events: none; 
        }

        /* Hover: 只有在 Random 模式下才會有明顯浮起效果 (由JS控制 class) */
        .gallery-img-container.random-hover:hover {
            z-index: 999 !important; /* 強制浮到最上層 */
            transform: scale(1.05) !important; /* 微微放大，這裡用 !important 覆蓋 inline style */
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
        }

        /* --- 底部控制列 --- */
        .controls {
            position: fixed; bottom: 40px; left: 50%; transform: translateX(-50%);
            z-index: 1000;
            display: flex; gap: 20px; align-items: center;
            background: rgba(255,255,255,0.9);
            backdrop-filter: blur(10px);
            padding: 12px 30px;
            border-radius: 50px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.08);
            border: 1px solid rgba(0,0,0,0.05);
        }

        .mode-btn {
            font-family: 'Inter', sans-serif;
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            cursor: pointer;
            color: #999;
            transition: color 0.3s;
            font-weight: 500;
        }
        .mode-btn.active { color: #000; font-weight: 700; }
        
        .toggle-track {
            width: 44px; height: 24px;
            background: #e0e0e0;
            border-radius: 20px;
            position: relative;
            cursor: pointer;
            transition: background 0.3s;
        }
        .toggle-thumb {
            width: 18px; height: 18px;
            background: #fff;
            border-radius: 50%;
            position: absolute;
            top: 3px; left: 3px;
            transition: left 0.3s cubic-bezier(0.2, 0.8, 0.2, 1);
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        /* Linear 狀態 */
        .toggle-track.linear-mode { background: #000; }
        .toggle-track.linear-mode .toggle-thumb { left: 23px; }

    </style>
</head>
<body>

    <header>
        <div class="header-content">
            <a href="index.html" class="logo">JAY POSH</a>
            <nav class="nav-links">
                <a href="index.html" class="nav-link">Home</a>
                <a href="#" class="nav-link active">Work</a>
                <a href="index.html#experience" class="nav-link">Info</a>
            </nav>
        </div>
    </header>

    <div id="gallery-canvas">
        <div class="gallery-img-container" data-type="portrait"><img src="images/split-1.jpg"></div>
        <div class="gallery-img-container" data-type="landscape"><img src="images/split-2.jpg"></div>
        <div class="gallery-img-container" data-type="portrait"><img src="images/work3.jpg"></div>
        <div class="gallery-img-container" data-type="landscape"><img src="images/work49.jpg"></div>
        <div class="gallery-img-container" data-type="portrait"><img src="images/work60.jpg"></div>
        <div class="gallery-img-container" data-type="landscape"><img src="images/p5.jpg"></div>
        <div class="gallery-img-container" data-type="portrait"><img src="images/split-3.jpg"></div>
        <div class="gallery-img-container" data-type="landscape"><img src="images/split-4.jpg"></div>
        <div class="gallery-img-container" data-type="portrait"><img src="images/work50.jpg"></div>
        <div class="gallery-img-container" data-type="landscape"><img src="images/work55.jpg"></div>
        <div class="gallery-img-container" data-type="portrait"><img src="images/p2.jpg"></div>
        <div class="gallery-img-container" data-type="landscape"><img src="images/work35.jpg"></div>
        <div class="gallery-img-container" data-type="portrait"><img src="images/work14.jpg"></div>
        <div class="gallery-img-container" data-type="landscape"><img src="images/work36.jpg"></div>
    </div>

    <div class="controls">
        <div class="mode-btn active" id="btn-random">Random</div>
        <div class="toggle-track" id="mode-toggle">
            <div class="toggle-thumb"></div>
        </div>
        <div class="mode-btn" id="btn-linear">Linear</div>
    </div>

    <script>
        const canvas = document.getElementById('gallery-canvas');
        const items = document.querySelectorAll('.gallery-img-container');
        const toggle = document.getElementById('mode-toggle');
        const btnRandom = document.getElementById('btn-random');
        const btnLinear = document.getElementById('btn-linear');

        let isLinear = false;
        
        // 拖曳變數
        let isDragging = false;
        let startX;
        let currentX = 0; 
        let dragX = 0;    

        // --- 核心計算：Random 佈局 (修正版：更平均、不靠邊) ---
        function setRandomLayout() {
            const vw = window.innerWidth;
            const vh = window.innerHeight;

            items.forEach((item, index) => {
                // 1. 啟用 Hover 放大效果
                item.classList.add('random-hover');

                // 2. 隨機大小 (稍微縮小一點，避免太擠)
                const width = Math.floor(Math.random() * (300 - 180) + 180); 
                const height = item.dataset.type === 'portrait' ? width * 1.35 : width * 0.7;

                // 3. 隨機位置 (限制範圍：螢幕寬度的 10%~80%，高度的 10%~70%)
                // 這樣就不會太靠下面，也不會太靠邊邊
                const minX = vw * 0.05;
                const maxX = vw * 0.75; // 留出右邊空間
                const minY = vh * 0.1;  // 避開 Header
                const maxY = vh * 0.6;  // 避開底部 Controls

                const x = Math.random() * (maxX - minX) + minX;
                const y = Math.random() * (maxY - minY) + minY;
                
                // 4. 隨機旋轉 (讓散落感更強)
                const rot = Math.random() * 20 - 10; // -10度 到 10度

                // 5. 隨機層級
                const z = Math.floor(Math.random() * 20);

                // 應用樣式
                item.style.width = `${width}px`;
                item.style.height = `${height}px`;
                // 這裡使用 translate3d 啟用硬體加速
                item.style.transform = `translate3d(${x}px, ${y}px, 0) rotate(${rot}deg)`;
                item.style.zIndex = z;
            });
        }

        // --- 核心計算：Linear 佈局 (修正版：垂直絕對置中) ---
        function setLinearLayout() {
            const vh = window.innerHeight;
            let currentLeft = window.innerWidth * 0.15; // 起始點從左邊 15% 開始

            items.forEach((item, index) => {
                // 1. 關閉 Hover 放大 (因為要整齊排列)
                item.classList.remove('random-hover');

                // 2. 統一高度 (這樣才會整齊)
                const fixedHeight = 350; 
                // 根據比例算寬度 (直式較窄，橫式較寬)
                const width = item.dataset.type === 'portrait' ? 250 : 500; 

                // 3. 垂直置中公式：(螢幕高度 - 圖片高度) / 2
                const y = (vh - fixedHeight) / 2;
                const x = currentLeft;

                // 應用樣式
                item.style.width = `${width}px`;
                item.style.height = `${fixedHeight}px`;
                // 這裡加上 dragX 實現拖曳捲動
                // 旋轉歸零 rotate(0deg)
                item.style.transform = `translate3d(${x + currentX + dragX}px, ${y}px, 0) rotate(0deg)`;
                
                // 讓所有圖片層級一樣，避免重疊順序怪怪的
                item.style.zIndex = 10 + index; 

                // 累加左邊距 (圖片寬度 + 40px 間距)
                currentLeft += width + 40; 
            });
        }

        // 更新拖曳位置 (只用於 Linear 模式)
        function updateDragPosition() {
            if (!isLinear) return;
            // 重新執行 Linear 排列，但帶入新的 dragX
            const vh = window.innerHeight;
            let currentLeft = window.innerWidth * 0.15;

            items.forEach((item) => {
                // 重新抓取剛才設定的寬高 (為了效能，這裡假設寬高不變)
                // 但為了精準，我們簡單重算一次位置
                const width = parseFloat(item.style.width);
                const height = parseFloat(item.style.height);
                const y = (vh - height) / 2;
                
                item.style.transform = `translate3d(${currentLeft + currentX + dragX}px, ${y}px, 0) rotate(0deg)`;
                currentLeft += width + 40;
            });
        }

        // --- 拖曳事件 ---
        canvas.addEventListener('mousedown', e => {
            if (!isLinear) return;
            isDragging = true;
            startX = e.clientX;
            canvas.classList.add('grabbing');
        });

        window.addEventListener('mouseup', () => {
            if (!isDragging) return;
            isDragging = false;
            currentX += dragX; // 儲存位移
            dragX = 0;
            canvas.classList.remove('grabbing');
        });

        window.addEventListener('mousemove', e => {
            if (!isDragging) return;
            e.preventDefault();
            dragX = e.clientX - startX;
            requestAnimationFrame(updateDragPosition);
        });

        // 支援觸控 (手機版)
        canvas.addEventListener('touchstart', e => {
            if (!isLinear) return;
            isDragging = true;
            startX = e.touches[0].clientX;
        });
        canvas.addEventListener('touchend', () => {
            if (!isDragging) return;
            isDragging = false;
            currentX += dragX;
            dragX = 0;
        });
        canvas.addEventListener('touchmove', e => {
            if (!isDragging) return;
            dragX = e.touches[0].clientX - startX;
            requestAnimationFrame(updateDragPosition);
        });


        // --- 切換開關 ---
        function switchMode(linear) {
            isLinear = linear;
            
            if (isLinear) {
                toggle.classList.add('linear-mode');
                btnLinear.classList.add('active');
                btnRandom.classList.remove('active');
                // 重置拖曳位置回起點
                currentX = 0; dragX = 0;
                setLinearLayout();
            } else {
                toggle.classList.remove('linear-mode');
                btnRandom.classList.add('active');
                btnLinear.classList.remove('active');
                setRandomLayout();
            }
        }

        toggle.addEventListener('click', () => switchMode(!isLinear));
        btnRandom.addEventListener('click', () => switchMode(false));
        btnLinear.addEventListener('click', () => switchMode(true));

        window.addEventListener('resize', () => {
            if (isLinear) setLinearLayout();
            else setRandomLayout();
        });

        // 初始執行
        setTimeout(() => {
            setRandomLayout();
        }, 100);

    </script>
</body>
</html>